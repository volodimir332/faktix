<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firestore Resilience Test</title>
    <style>
        body { font-family: Arial, sans-serif; background: #1a1a1a; color: white; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: #2a2a2a; padding: 20px; border-radius: 10px; }
        button { background: #10b981; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 10px 5px; }
        .status { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #065f46; color: #d1fae5; }
        .error { background: #7f1d1d; color: #fecaca; }
        .info { background: #1e3a8a; color: #dbeafe; }
        .warning { background: #92400e; color: #fef3c7; }
        .log { background: #1f2937; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è Firestore Resilience Test</h1>
        <p>–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Å—Ç—ñ–π–∫–æ—Å—Ç—ñ –¥–æ –ø–æ–º–∏–ª–æ–∫ Firestore –ø—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—ñ–≤</p>
        
        <div class="status info">
            <strong>‚ÑπÔ∏è –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó:</strong>
            <ol>
                <li>–í—ñ–¥–∫—Ä–∏–π—Ç–µ Developer Tools (F12) —ñ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É Console</li>
                <li>–°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å</li>
                <li>–í—ñ–¥–∫—Ä–∏–π—Ç–µ Faktix</li>
                <li>–°–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–¥–∞—Ç–∏ –∫–ª—ñ—î–Ω—Ç–∞</li>
                <li>–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –¥–æ–¥–∞—Ç–æ–∫ –Ω–µ –ø–∞–¥–∞—î –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö Firestore</li>
            </ol>
        </div>
        
        <button onclick="createTestProfile()">–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å</button>
        <button onclick="openFaktix()">–í—ñ–¥–∫—Ä–∏—Ç–∏ Faktix</button>
        <button onclick="testLocalStorage()">–¢–µ—Å—Ç—É–≤–∞—Ç–∏ localStorage</button>
        <button onclick="clearLogs()">–û—á–∏—Å—Ç–∏—Ç–∏ –ª–æ–≥–∏</button>
        
        <div class="status warning">
            <strong>‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ:</strong> –ü—ñ–¥ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—ñ–≤ —É Firebase Console –º–æ–∂—É—Ç—å –≤–∏–Ω–∏–∫–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏. 
            –î–æ–¥–∞—Ç–æ–∫ –ø–æ–≤–∏–Ω–µ–Ω –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ localStorage —è–∫ fallback.
        </div>
        
        <div id="logContainer" class="log">
            –õ–æ–≥–∏ –∑'—è–≤–ª—è—Ç—å—Å—è —Ç—É—Ç...
        </div>
        
        <div id="status"></div>
    </div>

    <script>
        function showStatus(message, type = 'info') {
            document.getElementById('status').innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function addLog(message) {
            const logContainer = document.getElementById('logContainer');
            const timestamp = new Date().toLocaleTimeString();
            logContainer.innerHTML += `[${timestamp}] ${message}\n`;
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function clearLogs() {
            const logContainer = document.getElementById('logContainer');
            logContainer.innerHTML = '–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω–æ...\n';
        }

        function createTestProfile() {
            const testProfile = {
                personal: {
                    firstName: "Jan",
                    lastName: "Nov√°k",
                    email: "test@example.com",
                    phone: "+420123456789",
                    address: "V√°clavsk√° 1",
                    city: "Praha",
                    postalCode: "11000",
                    country: "ƒåesk√° republika"
                },
                company: {
                    name: "Test Company s.r.o.",
                    vatNumber: "CZ12345678",
                    ico: "12345678",
                    address: "V√°clavsk√° 1",
                    city: "Praha",
                    postalCode: "11000",
                    country: "ƒåesk√° republika",
                    website: "https://example.com",
                    businessType: "Spoleƒçnost s ruƒçen√≠m omezen√Ωm (s.r.o.)",
                    typZivnosti: "≈òemeslnick√° ≈æivnost (80%)"
                },
                banking: {
                    accountNumber: "123456789/0100",
                    bankName: "Komerƒçn√≠ banka",
                    iban: "CZ6508000000192000145399",
                    swift: "KOMBCZPP",
                    currency: "CZK"
                },
                preferences: {
                    language: "cs",
                    currency: "CZK",
                    timezone: "Europe/Prague",
                    notifications: true
                }
            };

            localStorage.setItem('faktix-profile', JSON.stringify(testProfile));
            addLog('‚úÖ –¢–µ—Å—Ç–æ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å —Å—Ç–≤–æ—Ä–µ–Ω–æ –≤ localStorage');
            showStatus('‚úÖ –¢–µ—Å—Ç–æ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å —Å—Ç–≤–æ—Ä–µ–Ω–æ!', 'success');
        }

        function openFaktix() {
            window.open('http://localhost:3000', '_blank');
            addLog('üåê Faktix –≤—ñ–¥–∫—Ä–∏—Ç–æ –≤ –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ');
            showStatus('üåê Faktix –≤—ñ–¥–∫—Ä–∏—Ç–æ!', 'info');
        }

        function testLocalStorage() {
            try {
                const profile = localStorage.getItem('faktix-profile');
                const clients = localStorage.getItem('faktix-clients');
                
                addLog('üìä localStorage —Å—Ç–∞—Ç—É—Å:');
                addLog(`   –ü—Ä–æ—Ñ—ñ–ª—å: ${profile ? '‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ' : '‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ'}`);
                addLog(`   –ö–ª—ñ—î–Ω—Ç–∏: ${clients ? '‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ' : '‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ'}`);
                
                if (clients) {
                    const clientsData = JSON.parse(clients);
                    addLog(`   –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–ª—ñ—î–Ω—Ç—ñ–≤: ${clientsData.length}`);
                }
                
                showStatus('‚úÖ localStorage —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ', 'success');
            } catch (error) {
                addLog(`‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É localStorage: ${error.message}`);
                showStatus('‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É localStorage', 'error');
            }
        }

        window.onload = function() {
            addLog('üöÄ Firestore Resilience Test –≥–æ—Ç–æ–≤–∏–π!');
            addLog('üìã –û—á—ñ–∫—É–≤–∞–Ω—ñ –ª–æ–≥–∏ –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö Firestore:');
            addLog('   ‚ùå Error in clients subscription');
            addLog('   ‚ö†Ô∏è User not authenticated, using localStorage fallback');
            addLog('   üîÑ Falling back to localStorage...');
            showStatus('üöÄ –¢–µ—Å—Ç –≥–æ—Ç–æ–≤–∏–π! –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞.', 'info');
        };
    </script>
</body>
</html>
