# üîê –°–∏—Å—Ç–µ–º–∞ –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –°–µ—Å—ñ—ó –¥–ª—è SaaS

## ‚úÖ –©–æ –≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

### 1. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–π Auth State Listener
- **–§–∞–π–ª**: `src/lib/auth-state-listener.ts`
- **–§—É–Ω–∫—Ü—ñ—è**: –ì–ª–æ–±–∞–ª—å–Ω–∏–π —Å–ª—É—Ö–∞—á –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- **–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ**:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥—Å—Ç–µ–∂—É—î –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  - –ó–±–µ—Ä—ñ–≥–∞—î –≥–ª–æ–±–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
  - –ü—ñ–¥—Ç—Ä–∏–º—É—î –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É
  - –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 2. –ü–æ–∫—Ä–∞—â–µ–Ω–∏–π AuthGuard
- **–§–∞–π–ª**: `src/components/AuthGuard.tsx`
- **–§—É–Ω–∫—Ü—ñ—è**: –ó–∞—Ö–∏—Å—Ç —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
- **–õ–æ–≥—ñ–∫–∞**:
  - –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π + email –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π ‚Üí –¥–æ—Å—Ç—É–ø –¥–æ –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫
  - –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π + email –ù–ï –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ `/potvrdit-email`
  - –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –ª–µ–Ω–¥—ñ–Ω–≥ (`/`)

### 3. –û–Ω–æ–≤–ª–µ–Ω–∏–π useAuth Hook
- **–§–∞–π–ª**: `src/hooks/useAuth.ts`
- **–§—É–Ω–∫—Ü—ñ—è**: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–º Auth State Listener
- **–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ**:
  - –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É
  - –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π

### 4. AuthInitializer
- **–§–∞–π–ª**: `src/components/AuthInitializer.tsx`
- **–§—É–Ω–∫—Ü—ñ—è**: –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ Auth State Listener
- **–ú—ñ—Å—Ü–µ**: `src/app/layout.tsx` (–≥–ª–æ–±–∞–ª—å–Ω–æ)

## üöÄ –Ø–∫ –ø—Ä–∞—Ü—é—î —Å–∏—Å—Ç–µ–º–∞

### –ü—Ä–æ—Ü–µ—Å —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó:
1. **–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—É** ‚Üí AuthInitializer —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î Auth State Listener
2. **Auth State Listener** ‚Üí –ø—ñ–¥–ø–∏—Å—É—î—Ç—å—Å—è –Ω–∞ –∑–º—ñ–Ω–∏ Firebase Auth
3. **useAuth Hook** ‚Üí –ø—ñ–¥–ø–∏—Å—É—î—Ç—å—Å—è –Ω–∞ –∑–º—ñ–Ω–∏ –∑ Auth State Listener
4. **AuthGuard** ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–∞–Ω—ñ –∑ useAuth –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É —Å—Ç–æ—Ä—ñ–Ω–æ–∫

### –õ–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:

#### –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π + email –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π:
- **–ù–∞ –ø—É–±–ª—ñ—á–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ** ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ `/dashboard`
- **–ù–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ** ‚Üí –¥–æ—Å—Ç—É–ø –¥–æ–∑–≤–æ–ª–µ–Ω–∏–π

#### –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π + email –ù–ï –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π:
- **–ù–∞ –±—É–¥—å-—è–∫—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ** ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ `/potvrdit-email`
- **–ù–∞ `/potvrdit-email`** ‚Üí –¥–æ—Å—Ç—É–ø –¥–æ–∑–≤–æ–ª–µ–Ω–∏–π

#### –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ù–ï –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π:
- **–ù–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ** ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ `/` (–ª–µ–Ω–¥—ñ–Ω–≥)
- **–ù–∞ –ø—É–±–ª—ñ—á–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ** ‚Üí –¥–æ—Å—Ç—É–ø –¥–æ–∑–≤–æ–ª–µ–Ω–∏–π

### –ü—É–±–ª—ñ—á–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏:
- `/` (–ª–µ–Ω–¥—ñ–Ω–≥)
- `/prihlaseni` (–≤—Ö—ñ–¥)
- `/registrace` (—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è)
- `/test` (—Ç–µ—Å—Ç–æ–≤–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞)
- `/potvrdit-email` (–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email)

### –ü—Ä–∏–≤–∞—Ç–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏:
- `/dashboard` (–¥–∞—à–±–æ—Ä–¥)
- `/faktury` (—Ñ–∞–∫—Ç—É—Ä–∏)
- `/analytiky` (–∞–Ω–∞–ª—ñ—Ç–∏–∫–∞)
- `/profil` (–ø—Ä–æ—Ñ—ñ–ª—å)
- `/nastaveni` (–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è)
- `/klienti` (–∫–ª—ñ—î–Ω—Ç–∏)

## üîß –§—É–Ω–∫—Ü—ñ—ó API

### Auth State Listener:
```typescript
// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
initializeAuthStateListener()

// –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É
getCurrentUser()
getIsAuthenticated()
getIsEmailVerified()

// –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∑–º—ñ–Ω–∏
subscribeToAuthState(callback)

// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
checkPageAccess(pathname)
```

### useAuth Hook:
```typescript
const { user, isAuthenticated, isLoading, login, logout, register } = useAuth()
```

## üìù –õ–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ö–æ–Ω—Å–æ–ª—å–Ω—ñ –ª–æ–≥–∏:
- `üîê AuthInitializer` - —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Auth State Listener
- `üîê AuthGuard` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ —Å—Ç–æ—Ä—ñ–Ω–æ–∫
- `üîê useAuth` - –æ–ø–µ—Ä–∞—Ü—ñ—ó –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- `‚úÖ` - —É—Å–ø—ñ—à–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
- `‚ùå` - –ø–æ–º–∏–ª–∫–∏
- `üîÑ` - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

### –ü—Ä–∏–∫–ª–∞–¥ –ª–æ–≥—É–≤–∞–Ω–Ω—è:
```
üîê AuthInitializer: Initializing global auth state listener...
üîê Auth state changed: { user: "user123", email: "test@example.com", emailVerified: true }
‚úÖ User authenticated: { uid: "user123", email: "test@example.com", emailVerified: true }
üîê AuthGuard: Checking authentication for pathname: /dashboard
‚úÖ AuthGuard: User has access to private route
```

## üõ†Ô∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ—ó –ø—É–±–ª—ñ—á–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏:
1. –î–æ–¥–∞—Ç–∏ —à–ª—è—Ö –≤ `auth-state-listener.ts`:
```typescript
const publicRoutes = ['/', '/prihlaseni', '/registrace', '/test', '/potvrdit-email', '/nova-stranka'];
```

2. –î–æ–¥–∞—Ç–∏ —à–ª—è—Ö –≤ `AuthGuard.tsx`:
```typescript
const publicRoutes = ['/', '/prihlaseni', '/registrace', '/test', '/potvrdit-email', '/nova-stranka'];
```

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ—ó –ø—Ä–∏–≤–∞—Ç–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏:
1. –î–æ–¥–∞—Ç–∏ —à–ª—è—Ö –≤ `auth-state-listener.ts`:
```typescript
const privateRoutes = ['/dashboard', '/faktury', '/analytiky', '/profil', '/nastaveni', '/klienti', '/nova-privatna-stranka'];
```

2. –î–æ–¥–∞—Ç–∏ —à–ª—è—Ö –≤ `AuthGuard.tsx`:
```typescript
const privateRoutes = ['/dashboard', '/faktury', '/analytiky', '/profil', '/nastaveni', '/klienti', '/nova-privatna-stranka'];
```

## üîç –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –¢–µ—Å—Ç 1: –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `/dashboard`)
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ –ª–µ–Ω–¥—ñ–Ω–≥ (`/`)

### –¢–µ—Å—Ç 2: –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–µ–∑ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email
1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ `/potvrdit-email`
3. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ `/dashboard`
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –∑–Ω–æ–≤—É –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ `/potvrdit-email`

### –¢–µ—Å—Ç 3: –ü–æ–≤–Ω—ñ—Å—Ç—é –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á
1. –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ email
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –º–æ–∂–µ –∑–∞–π—Ç–∏ –Ω–∞ `/dashboard`
3. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ª–µ–Ω–¥—ñ–Ω–≥ (`/`)
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ `/dashboard`

### –¢–µ—Å—Ç 4: –í–∏—Ö—ñ–¥ –∑ —Å–∏—Å—Ç–µ–º–∏
1. –£–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
2. –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ –∫–Ω–æ–ø–∫—É "–í–∏–π—Ç–∏" –≤ Sidebar
3. –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –≤–∏—Ö—ñ–¥
4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ –ª–µ–Ω–¥—ñ–Ω–≥ (`/`)

## üö® –í—ñ–¥–æ–º—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

### –ü—Ä–æ–±–ª–µ–º–∞: AuthGuard –Ω–µ –ø—Ä–∞—Ü—é—î
**–†—ñ—à–µ–Ω–Ω—è**: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AuthGuard –≤–∫–ª—é—á–µ–Ω–∏–π –≤ `layout.tsx`:
```typescript
<AuthGuard>
  {children}
</AuthGuard>
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
**–†—ñ—à–µ–Ω–Ω—è**: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –ó–∞—Ü–∏–∫–ª—é–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—å
**–†—ñ—à–µ–Ω–Ω—è**: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –ø—É–±–ª—ñ—á–Ω—ñ —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏

## üìà –ú–æ–∂–ª–∏–≤—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

1. **–ö–µ—à—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω—É** - –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Å—Ç–∞–Ω—É –≤ localStorage
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤** - refresh token –ª–æ–≥—ñ–∫–∞
3. **–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ —Å–µ—Å—ñ–π** - –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —á–∞—Å—É —Å–µ—Å—ñ—ó
4. **–ë–∞–≥–∞—Ç–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è** - 2FA –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
5. **SSO —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è** - –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤

---

**üéâ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ —Å–µ—Å—ñ—ó —É—Å–ø—ñ—à–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞!**
–¢–µ–ø–µ—Ä –≤–∞—à SaaS –¥–æ–¥–∞—Ç–æ–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–µ—Ä—É—î —Å–µ—Å—ñ—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –∑–∞—Ö–∏—â–∞—î –ø—Ä–∏–≤–∞—Ç–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏.








